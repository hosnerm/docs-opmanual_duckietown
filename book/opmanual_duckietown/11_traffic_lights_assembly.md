# Traffic Lights Assembly {#traffic-light-assembly status=draft}

Maintainer: Eric Lu, Josefine Quack

Traffic lights are useful to coordinate heavy traffic at busy intersections during rush hour in Duckietown.  
This section describes the physical assembly and installation of traffic lights.  

## Overview

Traffic lights are crucial parts in modern cities. We rely on them to have well-organized traffic. While antonymous cars could communicate with each other through so many different kinds of communication protocol, humans can't. Unless you are a terminator, or a RoboCop, or Neo. In the near future where autonymous cars drive with human drivers, we still need the help of traffic lights.

About the hardware part, the traffic light is composed with two wooden boxes on the diagonal direction of an intersection. On of them is equipped with raspberry pi and other cables for localization usage.

TODO: Add a photo of one intersection with a traffic light.

Traffic lights node are expected to launch whenever they turn on.

## Assembly of the traffic light parts
This section shows how to assemble the components from the laser cut traffic light parts.

Warning: The small parts with the hole in te middle, i.e. the ones in the left of [](#fig:G-1), are not all equal. Some have a round hole, others a polygonal hole. Double check you are using the right ones in the process (compare with the pics).

<div class='requirements' markdown="1">

Requires: Laser cut traffic light parts []  

Requires: Strong wood glue []  

Result: Traffic light parts []  

Next: Traffic light assembly [](#sec:traffic-light-assembly).  
</div>  

All parts should be glued together as showed in the pictures.



### Tube holder with big ground plate  


<div figure-id="fig:G-1">
<img src="images/G-1.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:G-2">
<img src="images/G-2.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:G-3">
<img src="images/G-3.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:G-4">
<img src="images/G-4.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:G-5">
<img src="images/G-5.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:G-6">
<img src="images/G-6.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>    

<div figure-id="fig:G-7">
<img src="images/G-7.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:G-8">
<img src="images/G-8.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>  

### Tube holder with small ground plate

<div figure-id="fig:G2-1">
<img src="images/G2-1.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:G2-2">
<img src="images/G2-2.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:G2-3">
<img src="images/G2-3.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:G2-4">
<img src="images/G2-4.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:G2-5">
<img src="images/G2-5.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:G2-6">
<img src="images/G2-6.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:G2-7">
<img src="images/G2-7.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  



### Traffic light LED housing

<div figure-id="fig:L-1">
<img src="images/L-1.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:L-2">
<img src="images/L-2.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:L-3">
<img src="images/L-3.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:L-4">
<img src="images/L-4.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:L-5">
<img src="images/L-5.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:L-6">
<img src="images/L-6.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  



### Ground module cover
<div figure-id="fig:C-01">
<img src="images/C-01.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:C-02">
<img src="images/C-02.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  


### Joint module

<div figure-id="fig:J-1">
<img src="images/J-1.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:J-2">
<img src="images/J-2.jpg" style="width: 40%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:J-3">
<img src="images/J-3.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:J-4">
<img src="images/J-4.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:J-5">
<img src="images/J-5.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:J-6">
<img src="images/J-6.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:J-7">
<img src="images/J-7.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:J-8">
<img src="images/J-8.jpg" style="width: 50%"/>
<figcaption>
</figcaption>
</div>  

## Components of the traffic light {#tl-mat}
<div figure-id="fig:tl_components">
<img src="images/TL-01.jpg" style="width: 100%"/>
<figcaption>
Parts of a traffic light.
</figcaption>
</div>



These components are needed for one traffic light:

* Tube holder with big ground plate
* Tube holder with small ground plate (Duckietown)
* Cable with soldered LED strip
* Joint module (2x)
* Traffic light LED housing
* Raspberry Pi base plate
* Ground module cover (Duckietown)
* Camera mount
* Camera mount cover
* Short tube
* Medium tube (2x)
* Long tube with hole at the side
* Raspberry Pi
* Raspberry Pi shield
* M2.5x10 MF Nylon spacers (8x)
* M2.5x8 Nylon screws (4x)
* SD card with Duckietown software
* USB cable
* Ethernet cable
* Traffic sign stands (4x)
* Traffic sign stand supports (4x)

To fix things the following is needed:

* Tape
* Double-Sided Tape
* Wood glue or a hot glue gun


## Assembling the Traffic Light



### Put the LEDs into the housing

Bend the LED strip at an angle to reduce
the chance that the exposed soldered wires do not short.

<div figure-id="fig:L-0">
<img src="images/L-0.png" style="width: 80%"/>
<figcaption>
Bended LED strip cable
</figcaption>
</div>

<div figure-id="fig:TL-02">
<img src="images/TL-02.jpg" style="width: 80%"/>
<figcaption>
Cable with soldered LED strip LED housing
</figcaption>
</div>  
<div figure-id="fig:TL-03">
<img src="images/TL-03.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>  
Carefully push the LEDs into the designated holes.
<div figure-id="fig:TL-05">
<img src="images/TL-05.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:TL-04">
<img src="images/TL-04.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>  
Fix the LEDs with some tape, don't use glue.
<div figure-id="fig:TL-06">
<img src="images/TL-06.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>

### Connect the tubes


<div figure-id="fig:TL-07">
<img src="images/TL-07.jpg" style="width: 80%"/>
<figcaption>
Medium tubes and LED housing.
</figcaption>
</div>  
Stick the tubes into the sides of the LED housing and pull the cable through one side.
<div figure-id="fig:TL-08">
<img src="images/TL-08.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>  
Add the joint modules on the side of the tube without the cable.  
<div figure-id="fig:TL-09">
<img src="images/TL-09.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>  

<div figure-id="fig:TL-10">
<img src="images/TL-10.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>    
Mount the other joint module on the long tube, such that it aligns with the hole.

You can add additional tape under the joint modules to prevent them to slip down.
<div figure-id="fig:H-1">
<img src="images/H-1.png" style="width: 80%"/>
<figcaption>
Fully assembled traffic light.
</figcaption>
</div>


<div figure-id="fig:TL-11">
<img src="images/TL-11.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:TL-12">
<img src="images/TL-12.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:TL-13">
<img src="images/TL-13.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>  
Pull the cable through longer tube and stick the tube into the joint module.
<div figure-id="fig:TL-14">
<img src="images/TL-14.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:TL-15">
<img src="images/TL-15.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>  
Put the tubes into the tube holders.  

<div figure-id="fig:TL-16">
<img src="images/TL-16.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:TL-17">
<img src="images/TL-17.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>


### Connect the Raspberry Pi


Use the spacers and the screws to mount the
Raspberry Pi on the Raspberry Pi ground plate
as shown in the Picture.

<div figure-id="fig:TL-18">
<img src="images/TL-18.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>  
Plug the shield on top of the Raspberry Pi.  
Insert the SD card.  
Connect the LED cable to the shield.  
Connect the Ethernet cable.  
Connect the USB cable.
<div figure-id="fig:TL-19">
<img src="images/TL-19.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>  
If done correctly the LEDs should be on.  
<div figure-id="fig:TL-20">
<img src="images/TL-20.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>  
Close the ground module with the case.    

<div figure-id="fig:TL-21">
<img src="images/TL-21.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>
<div figure-id="fig:TL-22">
<img src="images/TL-22.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>

### Add traffic sign stands
<div figure-id="fig:TL-23">
<img src="images/TL-23.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>  
<div figure-id="fig:TL-24">
<img src="images/TL-24.jpg" style="width: 80%"/>
<figcaption>
</figcaption>
</div>  

### Fully assembled traffic light

<div figure-id="fig:TL-25">
<img src="images/TL-25.jpg" style="width: 80%"/>
<figcaption>
Fully assembled traffic light.
</figcaption>
</div>

Place the traffic light at an intersection such that the LEDs are exactly in the
middle and are facing each incoming lane perpendicular.
Use double-sided tape to fix the traffic light to the ground.



### Image Prepare
Prepare a Duckiebot image and remember to add your machine file (till 11.5)

<!-- See: [](#setup-duckiebot) -->
See setup-duckiebot
and this chapter
See rc-control
<!-- See: [](#rc-control) -->

Please use "tlo" for all traffic light/camera tower username, and "trafficlight#" for hostname. (# indicate 1, 2, 3..etc.) Also we suggest you to give every traffic light a same password.

After this step, you should have a traffic light image name.

    tlo@trafficlight1.local


### Launch Traffic Lights
SSH into the traffic light, and source environment

    duckiebot $ cd ~/duckietown
    duckiebot $ git checkout TL-megacity

After this step, launch traffic light node.

    duckiebot $ make traffic-light

You should see the traffic light shining like crazy now.
